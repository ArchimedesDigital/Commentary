/* istanbul ignore next */'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();var /* istanbul ignore next */_react = require('react'); /* istanbul ignore next */var _react2 = _interopRequireDefault(_react);
var /* istanbul ignore next */_RaisedButton = require('material-ui/RaisedButton'); /* istanbul ignore next */var _RaisedButton2 = _interopRequireDefault(_RaisedButton);
var /* istanbul ignore next */_Popover = require('material-ui/Popover'); /* istanbul ignore next */var _Popover2 = _interopRequireDefault(_Popover);
var /* istanbul ignore next */_Menu = require('material-ui/Menu'); /* istanbul ignore next */var _Menu2 = _interopRequireDefault(_Menu);
var /* istanbul ignore next */_MenuItem = require('material-ui/MenuItem'); /* istanbul ignore next */var _MenuItem2 = _interopRequireDefault(_MenuItem);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;}

var getDateRevision = function getDateRevision(revision) {
	if (revision.originalDate) return revision.originalDate;else
	if (revision.updated) return revision.updated;
	return revision.created;
}; /* istanbul ignore next */var

CommentCitation = function (_React$Component) {_inherits(CommentCitation, _React$Component);

	function /* istanbul ignore next */CommentCitation(props) {/* istanbul ignore next */_classCallCheck(this, CommentCitation);var _this = _possibleConstructorReturn(this, (CommentCitation.__proto__ || Object.getPrototypeOf(CommentCitation)).call(this,
		props));

		/* istanbul ignore next */_this.state = {
			openMenu: false,
			anchorEl: null }; /* istanbul ignore next */return _this;

	}_createClass(CommentCitation, [{ key: 'handleTouchTap', value: function handleTouchTap(

		event) {
			// This prevents ghost click.
			event.preventDefault();

			this.setState({
				openMenu: true,
				anchorEl: event.currentTarget });

		} }, { key: 'handleRequestClose', value: function handleRequestClose()

		{
			this.setState({
				openMenu: false });

		} }, { key: 'render', value: function render()

		{/* istanbul ignore next */var _props =

			this.props,commentId = _props.commentId,revisions = _props.revisions; /* istanbul ignore next */var _state =
			this.state,openMenu = _state.openMenu,anchorEl = _state.anchorEl;

			var styles = {
				menuItem: {
					fontFamily: 'ProximaNW01-AltLightReg' } };



			return (
				/* istanbul ignore next */_react2.default.createElement( /* istanbul ignore next */'div', /* istanbul ignore next */{ className: 'comment-citation' },
					/* istanbul ignore next */_react2.default.createElement( /* istanbul ignore next */_RaisedButton2.default, /* istanbul ignore next */{
						label: 'Cite this comment',
						labelPosition: 'after',
						onClick: this.handleTouchTap.bind(this) }),

					/* istanbul ignore next */_react2.default.createElement( /* istanbul ignore next */_Popover2.default, /* istanbul ignore next */{
							open: openMenu,
							anchorEl: anchorEl,
							anchorOrigin: { horizontal: 'left', vertical: 'top' },
							targetOrigin: { horizontal: 'left', vertical: 'bottom' },
							onRequestClose: this.handleRequestClose.bind(this) },

						/* istanbul ignore next */_react2.default.createElement( /* istanbul ignore next */_Menu2.default, /* istanbul ignore next */null,
							revisions.map(function (revision, i) {

								var updated = getDateRevision(revision);

								return (
									/* istanbul ignore next */_react2.default.createElement( /* istanbul ignore next */_MenuItem2.default, /* istanbul ignore next */{
										key: revision._id,
										href: /* istanbul ignore next */'/commentary/?_id=' + commentId + '&revision=' + i,
										primaryText: /* istanbul ignore next */'Revision ' + moment(updated).format('D MMMM YYYY'),
										style: styles.menuItem }));


							}),
							/* istanbul ignore next */_react2.default.createElement( /* istanbul ignore next */_MenuItem2.default, /* istanbul ignore next */{
								href: /* istanbul ignore next */'/commentary/?_id=' + commentId,
								primaryText: 'Comment link',
								style: styles.menuItem })))));





		} }]);return CommentCitation;}( /* istanbul ignore next */_react2.default.Component);

CommentCitation.propTypes = {
	commentId: /* istanbul ignore next */_react2.default.PropTypes.string.isRequired,
	revisions: /* istanbul ignore next */_react2.default.PropTypes.arrayOf( /* istanbul ignore next */_react2.default.PropTypes.shape({
		_id: /* istanbul ignore next */_react2.default.PropTypes.string.isRequired,
		created: /* istanbul ignore next */_react2.default.PropTypes.instanceOf(Date),
		updated: /* istanbul ignore next */_react2.default.PropTypes.instanceOf(Date),
		originalDate: /* istanbul ignore next */_react2.default.PropTypes.instanceOf(Date) })).
	isRequired }; /* istanbul ignore next */exports.default =


CommentCitation;